# Feature Definitions

Reference documentation for all computed features in the Gold layer.

---

## Customer Features

| Feature | Formula | Business Logic |
|---------|---------|----------------|
| `customer_lifetime_value` | `SUM(total_amount)` over all transactions | Total revenue generated by the customer across all orders |
| `purchase_frequency` | `COUNT(transaction_id)` | Total number of completed transactions |
| `average_order_value` | `CLV / purchase_frequency` | Mean revenue per order; 0 if no purchases |
| `days_since_last_purchase` | `reference_date - MAX(transaction_date)` | Recency indicator; NULL if no purchases |
| `recency_score` | `CASE` on days_since_last_purchase (≤30→5, ≤90→4, ≤180→3, ≤365→2, else→1) | 5 = most recent, 1 = least recent |
| `frequency_score` | `CASE` on total_orders (0→1, ≤2→2, ≤5→3, ≤10→4, else→5) | 5 = most frequent buyer |
| `monetary_score` | `CASE` on total_revenue ($0→1, ≤$100→2, ≤$500→3, ≤$1000→4, else→5) | 5 = highest spender |
| `customer_segment_score` | `R*0.35 + F*0.35 + M*0.30` | Weighted RFM composite; higher = more valuable |
| `avg_satisfaction` | `AVG(satisfaction_score)` from support tickets | Mean CSAT score (1–5 scale) |
| `total_reviews` | `COUNT(review_id)` | Number of product reviews submitted |
| `avg_review_rating` | `AVG(rating)` from reviews | Mean star rating given |
| `total_support_tickets` | `COUNT(ticket_id)` | Number of support interactions |
| `is_active` | From Silver `customers.is_active` | Boolean activity flag |
| `segment` | From Silver `customers.segment` | Customer segment label |

---

## Product Features

| Feature | Formula | Business Logic |
|---------|---------|----------------|
| `total_revenue` | `SUM(total_amount)` from transactions | Gross revenue for this product |
| `times_sold` | `COUNT(transaction_id)` | Number of sales transactions |
| `total_quantity_sold` | `SUM(quantity)` from transactions | Units moved |
| `revenue_contribution` | `product_revenue / SUM(all_revenue) * 100` | % share of total catalog revenue |
| `velocity_score` | `times_sold / active_months` | Sales frequency per month |
| `stock_turnover_rate` | `total_quantity_sold / stock_quantity` | Inventory efficiency; 0 if no stock |
| `profit_margin` | `(price - cost) / price * 100` | Gross margin %; NULL if cost missing |
| `price_tier` | `CASE` on price quartiles | 'Budget', 'Mid-Range', 'Premium', 'Luxury' |
| `avg_review_rating` | `AVG(rating)` from reviews | Mean star rating from customers |
| `review_count` | `COUNT(review_id)` | Number of reviews |
| `vendor_reliability_weighted_score` | `product_rating * (vendor_reliability / 100)` | Product quality adjusted by vendor reliability |

---

## Vendor Features

| Feature | Formula | Business Logic |
|---------|---------|----------------|
| `total_products_supplied` | `COUNT(product_id)` | Catalog breadth |
| `avg_product_rating` | `AVG(rating)` across vendor's products | Mean product quality |
| `revenue_generated` | `SUM(total_amount)` from product transactions | Total revenue from vendor's products |
| `product_quality_score` | `avg_rating * (reliability_score / 100)` | Quality weighted by vendor reliability |
| `total_invoices` | `COUNT(invoice_id)` | B2B invoice count |
| `invoice_payment_rate` | `paid_invoices / total_invoices * 100` | % of invoices paid |
| `average_invoice_value` | `AVG(total_amount)` from invoices | Mean invoice size |
| `total_outstanding_balance` | `SUM(total_amount)` WHERE status ≠ 'paid' | Unpaid invoice exposure |
| `avg_days_to_payment` | `AVG(payment_date - invoice_date)` | Mean payment turnaround |

---

## Invoice Features

| Feature | Formula | Business Logic |
|---------|---------|----------------|
| `days_to_payment` | `payment_date - invoice_date` | Calendar days until paid; NULL if unpaid |
| `days_overdue` | `CURRENT_DATE - due_date` if unpaid/overdue | Days past due; 0 if paid or not yet due |
| `line_item_diversity` | `COUNT(DISTINCT product_id)` in line items | Number of unique products per invoice |
| `total_line_items` | `COUNT(*)` from line items | Number of individual items |
| `line_items_total` | `SUM(line_total)` from line items | Computed total from line items |
| `discount_rate_achieved` | `days_early / payment_window * 100` | % of payment window saved by early payment |
| `reconciliation_flag` | `ABS(invoice_total - line_items_total) / invoice_total > 0.10` | TRUE if invoice total and line item totals diverge by > 10% |
| `vendor_name` | Joined from vendors table | Vendor display name |
| `vendor_reliability_score` | Joined from vendors table | Vendor reliability for context |
